#!/bin/bash

FILE="$1"
CMD="$2"
shift 2

if [[ ! -e "$FILE" ]]; then
    exit 1
fi

read -ra args <"$FILE"

if [[ ${#args} == 0 ]]; then
    args=(a 0)
fi

case "$CMD" in
    run)
        if [[ ${#@} != 0 ]]; then
            [[ $1 ]] && args[0]=$1
            [[ $2 ]] && args[1]=$2
            echo "${args[@]}" > "${FILE}"
        fi
        ;;
    cycle-type)
        if [[ "${args[0]}" == "a" ]]; then
            args[0]=d
        elif [[ "${args[0]}" == "d" ]]; then
            args[0]=f
        else
            args[0]=a
        fi
        echo "${args[@]}" > "${FILE}"
        ;;
    toggle-depth)
        if (( args[1] > 0 )); then
            args[1]=0
        else
            args[1]=1
        fi
        echo "${args[@]}" > "${FILE}"
        ;;
    *)
        exit 1
        ;;
esac

fzf-find "${args[@]}"
